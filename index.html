<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Boda | Javier Adrián & Nicole – 15 Mayo 2026</title>
  <meta name="description" content="Invitación de boda de Javier Adrián Tobar Hanze y Nicole Stefanie Benalcazar García – 15/05/2026" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Poppins:wght@300;400;500;700&family=Great+Vibes&display=swap" rel="stylesheet">
  <style>
    :root{
      --accent:#8B1E2D; --accent-2:#E6B8B8; --leaf:#386641;
      --ink:#1F2937; --paper:#FAF7F2; --shadow:0 10px 24px rgba(0,0,0,.12);
      --radius:18px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--paper);color:var(--ink);font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Arial,"Apple Color Emoji","Segoe UI Emoji";scroll-behavior:smooth}
    a{color:var(--accent)}
    .container{max-width:960px;margin:auto;padding:20px}
    header.hero{position:relative;overflow:hidden;border-radius:var(--radius);box-shadow:var(--shadow);background:#fff}
    .hero-grid{display:grid;grid-template-columns:1.2fr 1fr}
    .hero-img{min-height:440px;background:linear-gradient(135deg,#f8e9ec,#f4efe9)}
    .hero-content{padding:28px 28px 34px}
    .names{font-family:"Playfair Display",serif;font-weight:700;letter-spacing:.02em;font-size:clamp(28px,4vw,42px)}
    .amp{font-family:"Great Vibes",cursive;color:var(--accent);font-size:clamp(36px,6vw,64px);line-height:.9;display:inline-block;margin:0 .25em}
    .date{margin-top:6px;font-weight:600;color:var(--accent);letter-spacing:.18em}
    .countdown{display:flex;gap:10px;margin-top:18px}
    .pill{flex:1;text-align:center;background:var(--paper);border:1px solid #ece7df;border-radius:14px;padding:12px 8px}
    .pill b{display:block;font-size:22px}

    .section{margin:34px 0}
    .card{background:#fff;border-radius:var(--radius);box-shadow:var(--shadow);padding:22px}
    .two-col{display:grid;gap:18px;grid-template-columns:repeat(auto-fit,minmax(260px,1fr))}

    .title{font-family:"Playfair Display",serif;font-weight:700;font-size:26px;margin:0 0 8px}
    .subtitle{margin:0;color:#6b7280}

    .btn{display:inline-block;background:var(--accent);color:#fff;border:none;border-radius:12px;padding:12px 18px;font-weight:600;cursor:pointer;text-decoration:none}
    .btn.ghost{background:#fff;color:var(--accent);border:2px solid var(--accent)}
    .btn[disabled]{opacity:.6;cursor:not-allowed}

    .timeline{position:relative;margin-left:14px}
    .timeline::before{content:"";position:absolute;left:8px;top:0;bottom:0;width:2px;background:linear-gradient(180deg,var(--accent),transparent)}
    .t-item{position:relative;padding-left:28px;margin:16px 0}
    .t-dot{position:absolute;left:0;top:4px;width:16px;height:16px;border-radius:50%;background:var(--accent)}

    form label{display:block;font-weight:600;margin:12px 0 6px}
    input,select,textarea{width:100%;border:1px solid #e5e7eb;border-radius:10px;padding:12px;background:#fff}
    textarea{min-height:110px}
    .ok{color:#065f46;padding:12px 14px;background:#ecfdf5;border:1px solid #a7f3d0;border-radius:12px}
    .err{color:#9b1c1c;padding:12px 14px;background:#fef2f2;border:1px solid #fecaca;border-radius:12px}

    footer{margin:36px 0 28px;text-align:center;color:#6b7280}

    /* Animaciones */
    .reveal{opacity:0;transform:translateY(24px);transition:opacity .8s ease, transform .8s ease}
    .reveal.visible{opacity:1;transform:translateY(0)}
    .delay-1{transition-delay:.1s}
    .delay-2{transition-delay:.2s}

    .hidden{display:none}

    /* Música */
    .music-btn{position:fixed;right:16px;bottom:16px;background:#fff;border:2px solid var(--accent);color:var(--accent);border-radius:999px;padding:10px 14px;box-shadow:var(--shadow);font-weight:700}
    .music-btn.playing{background:var(--accent);color:#fff}

    /* Cards de regalos */
    .gift-grid{display:grid;gap:12px;grid-template-columns:repeat(auto-fill,minmax(180px,1fr))}
    .gift{border:1px solid #eee;border-radius:14px;overflow:hidden;background:#fff;display:flex;flex-direction:column}
    .gift img{width:100%;height:140px;object-fit:cover}
    .gift .g-body{padding:10px;display:flex;flex-direction:column;gap:8px}
    .g-meta{font-size:12px;color:#6b7280}
    .g-link{font-size:12px}
    .g-reserved{color:#065f46;background:#ecfdf5;border:1px solid #a7f3d0;border-radius:8px;padding:6px 8px}
    .g-error{color:#9b1c1c;background:#fef2f2;border:1px solid #fecaca;border-radius:8px;padding:6px 8px}
  </style>
</head>
<body>
  <div class="container">
    <!-- HERO -->
    <header class="hero reveal">
      <div class="hero-grid">
        <div class="hero-img" aria-label="Fondo artístico"></div>
        <div class="hero-content">
          <p class="subtitle" id="greeting">Queridos invitados</p>
          <h1 class="names">Javier Adrián <span class="amp">&</span> Nicole Stephanie</h1>
          <p class="subtitle">¡Nos casamos! Acompáñanos a celebrar nuestro amor.</p>
          <p class="date">15 · MAYO · 2026</p>

          <div class="countdown">
            <div class="pill"><b id="dLeft">0</b><small>DÍAS</small></div>
            <div class="pill"><b id="hLeft">0</b><small>HORAS</small></div>
            <div class="pill"><b id="mLeft">0</b><small>MIN</small></div>
            <div class="pill"><b id="sLeft">0</b><small>SEG</small></div>
          </div>

          <div style="margin-top:16px;display:flex;gap:10px;flex-wrap:wrap">
            <a class="btn" id="addCalendar" href="#">Agregar al calendario</a>
            <a class="btn ghost" href="#confirmar">Confirmar asistencia</a>
          </div>
        </div>
      </div>
    </header>

    <!-- CEREMONIA / RECEPCIÓN -->
    <section class="section">
      <div class="two-col">
        <article class="card reveal delay-1">
          <h2 class="title">Ceremonia</h2>
          <p class="subtitle">16:00 · Iglesia Casa de Fé</p>
          <p>Comparte con nosotros la ceremonia religiosa donde diremos “sí, acepto”.</p>
          <a class="btn" id="ceremonyMap" href="#" target="_blank" rel="noopener">Ver mapa</a>
        </article>
        <article class="card reveal delay-2">
          <h2 class="title">Recepción</h2>
          <p class="subtitle">20:00 · Lugar por confirmar</p>
          <p>Después de la ceremonia, celebremos bailando y brindando por el amor.</p>
          <p><strong>No niños</strong></p>
          <p class="subtitle">Amamos a los niños, pero hemos reservado sitios solo para adultos. Niños, dulces sueños.</p>
          <a class="btn" id="receptionMap" href="#" target="_blank" rel="noopener">Ver mapa</a>
        </article>
      </div>
    </section>

    <!-- CÓDIGO DE VESTIMENTA / ITINERARIO -->
    <section class="section two-col">
      <article class="card reveal delay-1">
        <h2 class="title">Código de vestimenta</h2>
        <p><strong>Formal</strong></p>
        <p><strong>Mujeres:</strong> de vestido largo · evitar vestidos rojo, beige, plateado, crema y gris.</p>
        <p><strong>Hombres:</strong> de traje · evitar azul claro.</p>
        <p>Reservamos el blanco para la novia.</p>
      </article>
      <article class="card reveal delay-2">
        <h2 class="title">Itinerario</h2>
        <div class="timeline">
          <div class="t-item"><span class="t-dot"></span><b>16:00</b> – Ceremonia</div>
          <div class="t-item"><span class="t-dot"></span><b>19:30</b> – Traslado y fotos</div>
          <div class="t-item"><span class="t-dot"></span><b>20:00</b> – Recepción</div>
          <div class="t-item"><span class="t-dot"></span><b>21:00</b> – Cena</div>
          <div class="t-item"><span class="t-dot"></span><b>23:30</b> – Baile</div>
        </div>
      </article>
    </section>

    <!-- MESA DE REGALOS / FOTOS -->
    <section class="section two-col">
      <article class="card reveal delay-1">
        <h2 class="title">Mesa de regalos</h2>
        <p>Tu presencia es nuestro mejor regalo. Para quienes deseen acompañarnos también con un detalle, hemos preparado una lista básica de artículos del hogar. Si lo prefieren, pueden hacerlo con sobre cerrado. ¡Gracias por su cariño!</p>
        <div style="display:flex;gap:12px;flex-wrap:wrap;margin-bottom:10px">
          <button class="btn" id="openGifts" type="button">Ver lista de regalos</button>
          <button class="btn ghost" id="openBanks" type="button">Ver datos para transferencia</button>
        </div>
      </article>
      <article class="card reveal delay-2">
        <h2 class="title">Comparte tus fotografías</h2>
        <p>Abre el enlace para subir tus fotos del evento.</p>
        <a class="btn" id="photosLink" href="https://example.com/fotos" target="_blank" rel="noopener">Abrir carpeta de fotos</a>
        <p class="subtitle">(Luego reemplaza el enlace por tu carpeta real)</p>
      </article>
    </section>

    <!-- BOTÓN PARA MOSTRAR RSVP -->
    <section id="confirmar" class="section">
      <article class="card reveal" style="text-align:center">
        <h2 class="title">¿Nos acompañas?</h2>
        <p class="subtitle">Pulsa el botón para confirmar y abrir el formulario.</p>
        <button class="btn" id="openRSVP">Confirmar asistencia</button>
      </article>
    </section>

    <!-- RSVP (OCULTO) -->
    <section id="rsvp" class="section hidden">
      <article class="card">
        <h2 class="title">Confirmar asistencia</h2>
        <p class="subtitle">Completa el formulario. Recibirás un correo con tu confirmación.</p>
        <form id="rsvpForm">
          <div class="two-col">
            <div>
              <label>Nombre completo</label>
              <input name="name" id="name" required />
            </div>
            <div>
              <label>Email</label>
              <input type="email" name="email" id="email" required />
            </div>
          </div>
          <div class="two-col">
            <div>
              <label>Teléfono</label>
              <input name="phone" id="phone" />
            </div>
            <div>
              <label>Número de acompañantes</label>
              <select name="guests" id="guests">
                <option value="0">Sólo yo</option>
              </select>
              <small class="subtitle">Límite permitido: <span id="guestLimitLabel">0</span></small>
            </div>
          </div>
          <div class="two-col">
            <div>
              <label>¿Asistirás?</label>
              <select name="attending" id="attending" required>
                <option value="Sí">Sí</option>
                <option value="No">No</option>
                <option value="Quizá">Quizá</option>
              </select>
            </div>
            <div>
              <label>Preferencias alimentarias</label>
              <input name="diet" id="diet" placeholder="Vegetariano, alergias, etc." />
            </div>
          </div>

          <div id="guestNamesWrap">
            <label>Nombres de acompañantes</label>
            <textarea name="guestNames" id="guestNames" placeholder="Ej.: Juan Pérez; María Gómez"></textarea>
          </div>

          <label>Mensaje</label>
          <textarea name="message" id="message" placeholder="Déjanos unas palabras…"></textarea>

          <input type="hidden" name="invitee" id="invitee" />
          <input type="hidden" name="code" id="code" />

          <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
            <button class="btn" type="submit">Enviar confirmación</button>
            <button class="btn ghost" type="reset">Limpiar</button>
          </div>
          <p id="formMsg" style="margin-top:14px"></p>
        </form>
      </article>
    </section>

    <footer class="reveal">
      Con amor, <b>Javier Adrián & Nicole</b> • 15 mayo 2026
    </footer>
  </div>

  <!-- MODAL -->
  <div id="modalBackdrop" class="hidden" style="position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:50"></div>
  <div id="modal" class="hidden" style="position:fixed;left:0;right:0;top:6vh;margin:auto;max-width:860px;background:#fff;border-radius:16px;box-shadow:var(--shadow);padding:22px;z-index:51">
    <h3 class="title" id="modalTitle">Título</h3>
    <div id="modalBody" class="subtitle">Contenido</div>
    <div style="text-align:right;margin-top:14px">
      <button class="btn" id="closeModal" type="button">Cerrar</button>
    </div>
  </div>

  <!-- MÚSICA -->
  <audio id="music" preload="auto" src="./music/tema.mp3"></audio>
  <button id="musicBtn" class="music-btn" aria-label="Reproducir música">♪</button>

  <script>
    // ====== CONFIG ======
    const WEDDING = {
      couple: { groom: "Javier Adrián Tobar Hanze", bride: "Nicole Stephanie Benalcazar García" },
      dateISO: "2026-05-15T16:00:00-05:00",
      ceremonyMap: "https://maps.google.com/?q=Iglesia%20Casa%20de%20F%C3%A9",
      receptionMap: "#",
      photosFolder: "https://example.com/fotos",
      // Apps Script Web App
      rsvpEndpoint: "https://script.google.com/macros/s/AKfycbw4DVo5jW2nYQxxh_0XY7CSPAiyaEuudDJfUvYFz71njXcWFrthxHO190LEwPRsw7IDuA/exec",
      // API de regalos (GET ?mode=gifts para listar, POST {action:'reserveGift'} para reservar)
      giftsApiBase: "https://script.google.com/macros/s/AKfycbw4DVo5jW2nYQxxh_0XY7CSPAiyaEuudDJfUvYFz71njXcWFrthxHO190LEwPRsw7IDuA/exec",
      defaultGuestLimit: 0
    };

    // --------- util modal ----------
    const modal = document.getElementById('modal');
    const modalBackdrop = document.getElementById('modalBackdrop');
    const modalTitle = document.getElementById('modalTitle');
    const modalBody = document.getElementById('modalBody');
    const closeModalBtn = document.getElementById('closeModal');
    function openModal(title, html){
      modalTitle.textContent = title;
      modalBody.innerHTML = html;
      modal.classList.remove('hidden');
      modalBackdrop.classList.remove('hidden');
    }
    function closeModal(){ modal.classList.add('hidden'); modalBackdrop.classList.add('hidden'); }
    closeModalBtn.addEventListener('click', closeModal);
    modalBackdrop.addEventListener('click', closeModal);

    // Personalización por querystring (?to=Nombre&code=XYZ&limit=N)
    const params = new URLSearchParams(location.search);
    const to = params.get('to'); const code = params.get('code'); const limitParam = Number(params.get('limit'));
    if (to) { greeting.textContent = `Para: ${to}`; name.value = to; invitee.value = to; }
    if (code) document.getElementById('code').value = code;

    // Countdown
    function updateCountdown(){
      const t = new Date(WEDDING.dateISO).getTime(), now=Date.now();
      let diff = Math.max(0, t-now);
      const d = Math.floor(diff/86400000); diff-=d*86400000;
      const h = Math.floor(diff/3600000); diff-=h*3600000;
      const m = Math.floor(diff/60000); diff-=m*60000;
      const s = Math.floor(diff/1000);
      dLeft.textContent=d; hLeft.textContent=h; mLeft.textContent=m; sLeft.textContent=s;
    }
    setInterval(updateCountdown,1000); updateCountdown();

    // Links
    ceremonyMap.href = WEDDING.ceremonyMap;
    receptionMap.href = WEDDING.receptionMap;
    photosLink.href = WEDDING.photosFolder;

    // Animaciones
    const io = new IntersectionObserver(entries => {
      entries.forEach(e=>{ if(e.isIntersecting){ e.target.classList.add('visible'); io.unobserve(e.target); }});
    }, { threshold:0.05 });
    document.querySelectorAll('.reveal').forEach(el=>io.observe(el));
    document.querySelector('header.hero')?.classList.add('visible');

    // Límite de acompañantes y mostrar/ocultar nombres
    const guestLimit = Number.isFinite(limitParam) ? limitParam : (WEDDING.defaultGuestLimit||0);
    guestLimitLabel.textContent = guestLimit;
    guests.innerHTML = '';
    for(let i=0;i<=guestLimit;i++){
      const opt = document.createElement('option');
      opt.value = String(i); opt.textContent = i===0 ? 'Sólo yo' : `+${i}`;
      guests.appendChild(opt);
    }
    const guestNamesWrap = document.getElementById('guestNamesWrap');
    function toggleGuestNames(){ guestNamesWrap.style.display = (Number(guests.value||0)===0)?'none':''; if(guestNamesWrap.style.display==='none'){guestNames.value='';} }
    toggleGuestNames(); guests.addEventListener('change', toggleGuestNames);

    // Música
    if(music){ music.loop = true; }
    musicBtn.addEventListener('click', ()=>{ if(music.paused){ music.play(); musicBtn.classList.add('playing'); } else { music.pause(); musicBtn.classList.remove('playing'); }});

    // Abrir RSVP
    openRSVP.addEventListener('click', ()=>{ rsvp.classList.remove('hidden'); rsvp.scrollIntoView({behavior:'smooth'}); try{ music.play(); musicBtn.classList.add('playing'); }catch{} });

    // .ics
    function buildICS(){
      const start = new Date(WEDDING.dateISO), end = new Date(start.getTime()+2*60*60*1000);
      const dt = d => d.toISOString().replace(/[-:]/g,'').split('.')[0]+'Z';
      const ics = `BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Boda//ES
BEGIN:VEVENT
UID:${Date.now()}@boda
DTSTAMP:${dt(new Date())}
DTSTART:${dt(start)}
DTEND:${dt(end)}
SUMMARY:Boda de ${WEDDING.couple.groom} y ${WEDDING.couple.bride}
LOCATION:Iglesia Casa de Fé
DESCRIPTION:¡Acompáñanos a celebrar!
END:VEVENT
END:VCALENDAR`;
      return 'data:text/calendar;charset=utf8,'+encodeURIComponent(ics);
    }
    addCalendar.href = buildICS();

    // Envío RSVP
    rsvpForm.addEventListener('submit', async (e)=>{
      e.preventDefault();
      formMsg.textContent='Enviando…'; formMsg.className='subtitle';
      const data = Object.fromEntries(new FormData(rsvpForm).entries());
      const selected = Number(data.guests||0);
      const names = (data.guestNames||'').split(/[,;\n]+/).map(s=>s.trim()).filter(Boolean);
      if(selected>0 && names.length!==selected){ formMsg.innerHTML='<span class="err">Indica exactamente los nombres de tus '+selected+' acompañantes.</span>'; return; }
      if(selected>guestLimit){ formMsg.innerHTML='<span class="err">Tu límite de acompañantes es '+guestLimit+'.</span>'; return; }
      data.timestamp = new Date().toISOString();
      try{
        const res = await fetch(WEDDING.rsvpEndpoint,{method:'POST',mode:'cors',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});
        if(!res.ok) throw new Error();
        formMsg.innerHTML='<span class="ok">¡Recibido! Te llegará un correo de confirmación pronto.</span>';
        rsvpForm.reset(); toggleGuestNames();
      }catch{ formMsg.innerHTML='<span class="err">Ocurrió un error. Intenta nuevamente o contáctanos.</span>'; }
    });

    // ------- Ventana de REGALOS con fotos + reservar -------
    document.getElementById('openGifts').addEventListener('click', async ()=>{
      openModal('Lista de regalos', `<div class="subtitle">Cargando…</div>`);
      try{
        const url = WEDDING.giftsApiBase + '?mode=gifts';
        const res = await fetch(url, {mode:'cors'});
        const gifts = await res.json(); // [{id,name,image,link,reservedBy,reservedEmail,reservedAt}]
        if(!Array.isArray(gifts) || gifts.length===0){
          modalBody.innerHTML = '<p class="subtitle">Aún no hay regalos cargados.</p>'; return;
        }
        const grid = document.createElement('div'); grid.className='gift-grid';
        gifts.forEach(g=>{
          const card = document.createElement('div'); card.className='gift';
          const img = document.createElement('img'); img.src = g.image || 'https://images.unsplash.com/photo-1517245386807-bb43f82c33c4?w=640&q=60'; img.alt=g.name||'Regalo';
          const body = document.createElement('div'); body.className='g-body';
          const name = document.createElement('div'); name.innerHTML = `<strong>${g.name||''}</strong>`;
          const meta = document.createElement('div'); meta.className='g-meta';
          const link = document.createElement('a'); link.className='g-link'; link.href=g.link||'#'; link.target='_blank'; link.rel='noopener'; link.textContent='Ver en tienda';
          const btn = document.createElement('button'); btn.className='btn'; btn.textContent='Reservar'; btn.style.width='100%';

          body.appendChild(name);
          if(g.link) body.appendChild(link);

          if(g.reservedBy){
            const r = document.createElement('div'); r.className='g-reserved';
            r.innerHTML = `Reservado por <b>${g.reservedBy}</b>${g.reservedAt?`<br><small>${g.reservedAt}</small>`:''}`;
            btn.disabled = true; btn.textContent='Reservado';
            body.appendChild(r);
          } else {
            btn.addEventListener('click', async ()=>{
              const byName = prompt('Tu nombre para reservar este regalo:');
              if(!byName) return;
              const byEmail = prompt('Tu correo (opcional):') || '';
              btn.disabled = true; btn.textContent='Reservando…';
              try{
                const r = await fetch(WEDDING.giftsApiBase, {
                  method:'POST', mode:'cors',
                  headers:{'Content-Type':'application/json'},
                  body: JSON.stringify({ action:'reserveGift', id: String(g.id), byName, byEmail })
                });
                const j = await r.json();
                if(!j.ok) throw new Error(j.error||'');
                // refrescar tarjeta
                body.innerHTML = `<strong>${g.name||''}</strong>`;
                if(g.link){ const a=document.createElement('a'); a.href=g.link; a.target='_blank'; a.rel='noopener'; a.textContent='Ver en tienda'; a.className='g-link'; body.appendChild(a); }
                const rbox = document.createElement('div'); rbox.className='g-reserved';
                rbox.innerHTML = `Reservado por <b>${byName}</b><br><small>${j.reservedAt||''}</small>`;
                body.appendChild(rbox);
              }catch(err){
                const e = document.createElement('div'); e.className='g-error'; e.textContent = 'No se pudo reservar. Puede que alguien se te haya adelantado.';
                body.appendChild(e);
                btn.disabled=false; btn.textContent='Reservar';
              }
            });
            body.appendChild(btn);
          }

          card.appendChild(img); card.appendChild(body); grid.appendChild(card);
        });
        modalBody.innerHTML=''; modalBody.appendChild(grid);
      }catch(err){
        modalBody.innerHTML = '<p class="err">No se pudo cargar la lista por ahora.</p>';
      }
    });

    // Datos bancarios
    document.getElementById('openBanks').addEventListener('click', ()=>{
      openModal('Datos para transferencia', `
        <div class="subtitle" style="line-height:1.8">
          <p><strong>Banco Guayaquil</strong><br/>Cuenta de Ahorros <b>#3782519</b></p>
          <p><strong>Produbanco</strong><br/>Cuenta de Ahorros <b>#20000521092</b></p>
          <p><strong>Banco de Pichincha</strong><br/>Cuenta Corriente <b>#2100271621</b></p>
          <hr/>
          <p><strong>Nombre:</strong> Javier Adrián Tobar Hanze<br/>
             <strong>Cédula:</strong> 0940960370<br/>
             <strong>Correo:</strong> adriantobar97@gmail.com<br/>
             <strong>Celular:</strong> 0999170015</p>
        </div>
      `);
    });
  </script>
</body>
</html>
